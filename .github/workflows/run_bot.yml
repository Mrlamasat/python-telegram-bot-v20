# .github/workflows/run-bot.yml
name: Run Telegram Bot

on:
  push:
    branches:
      - main
  workflow_dispatch:

jobs:
  run-bot:
    runs-on: ubuntu-24.04

    steps:
    - name: Checkout Repository
      uses: actions/checkout@v3

    - name: Setup Python
      uses: actions/setup-python@v4
      with:
        python-version: 3.12

    - name: Upgrade pip and install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install pyrogram asyncpg TgCrypto psycopg2-binary

    - name: Run Bot with auto-restart
      env:
        BOT_TOKEN: ${{ secrets.BOT_TOKEN }}
        API_ID: ${{ secrets.API_ID }}
        API_HASH: ${{ secrets.API_HASH }}
        SESSION_STRING: ${{ secrets.SESSION_STRING }}
        SOURCE_CHANNEL: ${{ secrets.SOURCE_CHANNEL }}
        DATABASE_URL: ${{ secrets.DATABASE_URL }}
      run: |
        echo "ЁЯЪА ╪и╪п╪б ╪к╪┤╪║┘К┘Д ╪з┘Д╪и┘И╪к..."
        # ╪н┘Д┘В╪й ┘Д╪е╪╣╪з╪п╪й ╪з┘Д╪к╪┤╪║┘К┘Д ╪з┘Д╪к┘Д┘В╪з╪ж┘К ╪╣┘Ж╪п ╪г┘К ╪о╪╖╪г
        while true; do
          python bot.py
          echo "тЪая╕П ╪з┘Д╪и┘И╪к ╪к┘И┘В┘Б. ╪│┘К╪к┘Е ╪е╪╣╪з╪п╪й ╪з┘Д╪к╪┤╪║┘К┘Д ╪о┘Д╪з┘Д 5 ╪л┘И╪з┘Ж┘Н..."
          sleep 5
        done
